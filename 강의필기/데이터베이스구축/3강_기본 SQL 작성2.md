# 3강 - 기본 SQL 작성2

# `학습개요`

학습목표

- 데이터베이스 객체에 대한 개념을 설명할 수 있다.
- 데이터 정의어의 개념을 설명할 수 있다.
- 데이터베이스의 테이블에 대한 개념을 설명할 수 있다.
- 테이블 관리 및 데이터 사전에 대한 개념을 설명할 수 있다.
- 트랜잭션에 대한 개념 및 사용벙을 설명할 수 있다.

학습내용

- 데이터베이스 객체 관리
- 트랜잭션 관리
- 기본 SQL



# `생각해보기`

<img src="3강_기본 SQL 작성2.assets/image-20220921142752678.png" alt="image-20220921142752678" style="zoom:50%;" /> 



# `데이터 정의어`

#### DDL(Data Definition Language)

- 데이터베이스 객체를 정의하는 언어
- DBMS가 관리하는 테이브로가 뷰, 인덱스 등

<img src="3강_기본 SQL 작성2.assets/image-20220921143127855.png" alt="image-20220921143127855" style="zoom:50%;" /> 

#### DDL 조작 방법

객체를 생성, 변경, 제거하기 사용하는 명령어

- 생성 : CREATE , 데이터베이스 객체 생성
- 변경 : ALTER, 데이터베이스 객체 변경
- 삭제 :
  -  DROP, 데이터베이스 객체 삭제
  - TRUNCATE , 데이터베이스 객체 내용 삭제

#### DDL문 특징

- 데이터베이스 스키마를 컴퓨터가 이해할 수 있도록 기술함
- 주로 데이터베이스 관리자나 데이터베이스 설계자가 사용함
- 데이터베이스의 메타데이터로 Data Dictionary에 저장
- 데이터베이스 스키마를 컴퓨터가 이해할 수 있도록 기술하는데 사용함
- 논리적 데이터 구조를 정의(스키마/외부 스키마 기술)함 -> 개념적으로 접근
- 물리적 데이터 구조를 정의(내부 스키마 기술)함  -> 실제적으로 저장되는것
- 명령 실행 후 기본적으로 Auto Commit(트랜잭션의 끝으로 간주)됨



# `테이블 관리`

#### 테이블의 개념

데이터를 저장하는 객체(Object)로서, 관계형 데이터베이스 기본 단위

행과 열의 2차원 표 형태로 동일한 형식을 갖는 객체들을 저장함

- 학생들의 정보를 저장하기 위해 작성한 학번, 이름, 학과 컬럼을 갖는 표

#### 테이블의 특징

- 어느 특정한 주제와 목적으로 만들어짐
- 테이블은 반드시 하나 이상의 컬럼을 가짐
- 테이블에는 등록된 자료들일 있으며, 이자료들은 삭제하지 않는 한 지속해서 유지됨

#### 테이블의 구조

관계형 데이터베이스에서는 모든 데이터를 컬럼과 행의 2차원 구조로 나타냄

<img src="3강_기본 SQL 작성2.assets/image-20220921144342572.png" alt="image-20220921144342572" style="zoom:50%;" /> 

#### 테이블의 용어

<img src="3강_기본 SQL 작성2.assets/image-20220921144446521.png" alt="image-20220921144446521" style="zoom:50%;" /> 

#### 테이블 생성

DDL 사용 방법은 두 종류로 분류할 수 있음

<img src="3강_기본 SQL 작성2.assets/image-20220921144638255.png" alt="image-20220921144638255" style="zoom:50%;" /> 

#### 테이블 변경

<img src="3강_기본 SQL 작성2.assets/image-20220921144740794.png" alt="image-20220921144740794" style="zoom:50%;" /> 

#### 테이블 삭제, 절단, 이름 변경

DROP TABLE, TRUNCATE TABLE, RENAME TABLE 명령문을 사용하여 테이블을 삭제하거나 내용을 절단하고 이름을 변경함

<img src="3강_기본 SQL 작성2.assets/image-20220921144848947.png" alt="image-20220921144848947" style="zoom:50%;" /> 

#### 제약 조건 유형

테이블 생성 시 컬럼 또는 테이블에 대한 제약 조건을 설정할 수 있음

테이블 생성을 위한 CREATE문에 제약조건을 명시하는 형태로 사용하며, ALTER를 통해 테이블의 제약 조건 변경이 가능함

#### 테이블 생성 시 사용되는 제약조건

<img src="3강_기본 SQL 작성2.assets/image-20220921145007862.png" alt="image-20220921145007862" style="zoom:50%;" /> 



# `데이터 사전(시스템 카탈로그)`

#### 개념

데이터사전 : 시스템 테이블

- 데이터베이스의 객체(사용자, 릴레이션, 뷰, 인덱스, 권한 등)와 구조들에 관한 모든 데이터를 포함하는 시스템 데이터베이스

메타데이터

- 데이터사전에 저장된 정보
- 데이터에 관련된 데이터

관계 DBMS마다 표준화되어 있지 않아서 관계 DBMS마다 서로 다른 형태로 시스템 카탈로그 기능을 제공

사용자가 SQL문으로 내용 검색이 가능

데이터베이스 관리 시스템에 의해 생성 및 유지

#### 내용

안에 존재하는 메타데이터의 유형과 내용

<img src="3강_기본 SQL 작성2.assets/image-20220921150318403.png" alt="image-20220921150318403" style="zoom:50%;" /> 

데이터 사전 내용이 메타데이터라는 것은 모든 DBMS의 공통

- 데이터 사전을 구현하는 방법 관리하는 방법 등의 차이로 메타데이터의 구체적인 내용은 제품하다 다름

#### 용도

- 사용자에게 데이터 사전은 단순 조회의 대상

- 데이터베이스 엔진을 이루는 컴파일러, 옵티마이저 등과 같은 구성 요소에 데이터 사전은 

  작업을 수행하는데 필요한 참조 정보일 뿐만 아니라 작업의 대상

#### 오라클에서 데이터 사전 검색

<img src="3강_기본 SQL 작성2.assets/image-20220921150452834.png" alt="image-20220921150452834" style="zoom:50%;" /> 

#### 오라클 데이터 사전 영역

<img src="3강_기본 SQL 작성2.assets/image-20220921150610161.png" alt="image-20220921150610161" style="zoom:50%;" /> 

####  MYSQL에서 데이터 사전 검색 

- 데이터 사전은 테이블 형태로 구성되어 있음
- Information_schema라는 데이터베이스 안에 존재

<img src="3강_기본 SQL 작성2.assets/image-20220921150731916.png" alt="image-20220921150731916" style="zoom:50%;" /> 



# `트랜잭션 개요`

#### 개념

트랜잭션 

- 데이터베이스의 상태를 변화시키기 위해서 수행하는 작업의 단위
- 사용자가 시스템에 대한 서비스 요구 시 시스템이 응답하기 위한 상태 변환 과정의 작업 단위

하나의 트랜잭션은 COMMIT 또는 ROLLBACK 됨

#### 특징

데이터의 무결성을 보장하기 위해 DBMS의 트랜잭션이 가져야 할 특징

<img src="3강_기본 SQL 작성2.assets/image-20220921154733781.png" alt="image-20220921154733781" style="zoom:50%;" /> 

<img src="3강_기본 SQL 작성2.assets/image-20220921154744731.png" alt="image-20220921154744731" style="zoom:50%;" /> 

#### COMMIT, ROLLBACK 연산

<img src="3강_기본 SQL 작성2.assets/image-20220921154907341.png" alt="image-20220921154907341" style="zoom:50%;" /> 

#### 트랜잭션의 상태 변화

<img src="3강_기본 SQL 작성2.assets/image-20220921154932361.png" alt="image-20220921154932361" style="zoom:50%;" /> 

#### 트랜잭션의 상태

<img src="3강_기본 SQL 작성2.assets/image-20220921154949774.png" alt="image-20220921154949774" style="zoom: 50%;" /> 

#### 트랜잭션 제어

흐름의 구조를 바꾼다는 것이 아니라 트랜잭션의 겨로가를 수용하거나 취소하는 것

##### 트랜잭션 제어 언어는 TCL(Transaction Control Lnguage)이 있음

#### TCL 명령어

<img src="3강_기본 SQL 작성2.assets/image-20220921155053424.png" alt="image-20220921155053424" style="zoom:50%;" /> 



# `체크포인트`

#### 개요

DBMS는 회복 시 재 수행할 트랜잭션의 수를 줄이기 위해서 주기적으로 체크포인트를 수행함

- 체크포인트 시점에 주 기억 장치의 버퍼 내용이 디스크에 강제로 기로됨
- 체크포인트 시점에 디스크상에서 로그와 데이터베이스의 내용이 일치하게 됨

체크포인트 작업이 끝나면 로그에 [checkpoint]로그 레코드가 기록됨

- 일반적으로 체크포인트는 10~20분마다 한번씩 수행함

#### 체크포인트를 이용한 트랜잭션 제어

<img src="3강_기본 SQL 작성2.assets/image-20220921155319451.png" alt="image-20220921155319451" style="zoom:50%;" /> 

#### 체크포인트를 이용한 트랜잭션 제어

저장점 A로 되돌리고 나서 다시 B 지점으로 되돌릴 수는 없음

<img src="3강_기본 SQL 작성2.assets/image-20220921155415897.png" alt="image-20220921155415897" style="zoom:50%;" /> 

<img src="3강_기본 SQL 작성2.assets/image-20220921155422856.png" alt="image-20220921155422856" style="zoom:50%;" /> 



# `병행제어(동시성제어, Concurrency Control)`

### 개요

병행제어(동시성 제어)

- 다중 사용자 환경을 지원하는 데이터베이스 시스템에서 여러 트랜잭션이 성공적으로 동시에 실행될 수 있도록 지원하는 기능
- 다중 사용자 환경을 지원하는 DB System의 경우 필수적으로 지원해야 하는 기능

<img src="3강_기본 SQL 작성2.assets/image-20220921155754577.png" alt="image-20220921155754577" style="zoom:50%;" /> 

### 병행제어를 하지 않으면 발생하는 문제점

<img src="3강_기본 SQL 작성2.assets/image-20220921155820787.png" alt="image-20220921155820787" style="zoom:50%;" /> 

<img src="3강_기본 SQL 작성2.assets/image-20220921155904846.png" alt="image-20220921155904846" style="zoom:50%;" /> 

<img src="3강_기본 SQL 작성2.assets/image-20220921160106354.png" alt="image-20220921160106354" style="zoom:50%;" /> 

<img src="3강_기본 SQL 작성2.assets/image-20220921160242959.png" alt="image-20220921160242959" style="zoom:50%;" /> 

### 기법

#### 2단계 잠금 기법

<img src="3강_기본 SQL 작성2.assets/image-20220921160355586.png" alt="image-20220921160355586" style="zoom:50%;" /> 

<img src="3강_기본 SQL 작성2.assets/image-20220921160427476.png" alt="image-20220921160427476" style="zoom:50%;" /> 

<img src="3강_기본 SQL 작성2.assets/image-20220921160457682.png" alt="image-20220921160457682" style="zoom:50%;" /> 



#### 타임 스탬프 순서 기법

<img src="3강_기본 SQL 작성2.assets/image-20220921160526306.png" alt="image-20220921160526306" style="zoom:50%;" /> 



#### 검증 기법

<img src="3강_기본 SQL 작성2.assets/image-20220921160557793.png" alt="image-20220921160557793" style="zoom:50%;" /> 



# `회복(Recovery)`

### 개요

데이터베이스를 갱신하는 도중에 고장나도 데이터베이스의 일관성을 유지하는 DBMS기능

### 장애의 유형

<img src="3강_기본 SQL 작성2.assets/image-20220921160704552.png" alt="image-20220921160704552" style="zoom:50%;" /> 

<img src="3강_기본 SQL 작성2.assets/image-20220921160716876.png" alt="image-20220921160716876" style="zoom:50%;" /> 

### 회복기법

<img src="3강_기본 SQL 작성2.assets/image-20220921160819185.png" alt="image-20220921160819185" style="zoom:50%;" /> 

<img src="3강_기본 SQL 작성2.assets/image-20220921160846622.png" alt="image-20220921160846622" style="zoom:50%;" /> 



#### 지연 갱신 기법

<img src="3강_기본 SQL 작성2.assets/image-20220921160924175.png" alt="image-20220921160924175" style="zoom:50%;" /> 



#### 즉시 갱신 기법

<img src="3강_기본 SQL 작성2.assets/image-20220921161010786.png" alt="image-20220921161010786" style="zoom:50%;" /> 



#### 그림자 페이지 기법

<img src="3강_기본 SQL 작성2.assets/image-20220921161022715.png" alt="image-20220921161022715" style="zoom:50%;" /> 



#### 검사점 기법

<img src="3강_기본 SQL 작성2.assets/image-20220921161048474.png" alt="image-20220921161048474" style="zoom:50%;" /> 



#### 미디어 회복 기법

<img src="3강_기본 SQL 작성2.assets/image-20220921161120635.png" alt="image-20220921161120635" style="zoom:50%;" /> 



# `테이블, 트랜잭션 실습`











